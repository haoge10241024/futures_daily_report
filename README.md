# 期货日报生成系统（AI赋能版）

[![Streamlit](https://img.shields.io/badge/Streamlit-FF4B4B?style=for-the-badge&logo=Streamlit&logoColor=white)](https://streamlit.io/)
[![Python](https://img.shields.io/badge/Python-3.9+-3776AB?style=for-the-badge&logo=python&logoColor=white)](https://www.python.org/)
[![DeepSeek](https://img.shields.io/badge/DeepSeek-AI-blue?style=for-the-badge)](https://www.deepseek.com/)

一个专业的期货日报自动生成系统，结合AI智能分析与多维度数据整合，帮助分析师快速生成高质量的期货市场日报。

**Created by 7haoge (953534947@qq.com)**

---

## 📖 系统简介

### 🎯 项目目的

传统的期货日报编写需要分析师花费大量时间收集数据、分析行情、整理新闻，本系统旨在：

- ⏱️ **节省时间**：自动化数据采集与K线图生成，从数小时缩短到数分钟
- 🤖 **智能辅助**：AI驱动的行情分析和观点生成，提供专业参考
- 📊 **多维整合**：整合技术面、基本面、资金面等8大维度数据
- 📰 **新闻聚合**：自动搜集多源财经新闻，智能筛选重要资讯
- ✍️ **灵活编辑**：AI生成内容可自由编辑，保持人工审核把关
- 📄 **专业输出**：一键生成符合机构标准的Word格式日报

### 🔬 技术原理

#### 数据层
- **市场数据**：通过AkShare开源接口获取实时期货行情数据
- **技术指标**：自动计算MA、MACD、RSI、布林带等技术指标
- **新闻数据**：多源聚合（东方财富、金融界、RSS、Serper API）
- **专业数据**：搜索库存、仓单、基差、持仓席位等8大维度数据

#### AI层
- **DeepSeek AI**：强大的中文理解和生成能力，用于行情描述、观点分析
- **低温度参数**：temperature=0.1-0.2，确保生成内容的准确性和稳定性
- **四重约束机制**：通过Prompt工程严格约束AI，禁止编造数据
- **多维度提示词**：引导AI从技术面、基本面、资金面等多角度分析

#### 应用层
- **Streamlit框架**：快速构建交互式Web应用
- **会话状态管理**：保持用户操作状态，支持多步骤编辑
- **Word文档生成**：python-docx库生成专业排版的日报文档

#### 工作流程
```
用户输入 → 数据获取 → K线生成 → AI分析 → 人工编辑 → 文档导出
   ↓          ↓          ↓         ↓         ↓          ↓
 品种/日期   AkShare   matplotlib  DeepSeek  Streamlit  python-docx
```

---

## ✨ 核心特性

### 🌍 全品种支持
- **有色金属**：铜、铝、锌、铅、镍、锡
- **黑色金属**：螺纹钢、热卷、铁矿石、焦炭、焦煤、硅铁、锰硅
- **能源化工**：原油、PTA、甲醇、PVC、PP、橡胶、沥青、燃料油
- **农产品**：豆粕、豆油、玉米、白糖、棉花、鸡蛋、生猪、苹果
- **贵金属**：黄金、白银
- **其他**：50+个活跃期货品种

### 🤖 AI智能生成

#### 行情描述生成
- 基于真实K线数据和技术指标
- 自动生成日盘/夜盘走势分析
- 四重约束确保数据准确性
- 禁止AI推测或编造数字

#### 主要观点生成（8维度专业分析）
1. **技术面**：MA、MACD、RSI、布林带等技术指标
2. **基本面**：供需平衡、库存变化、产量数据
3. **资金面**：持仓变化、席位分析、资金流向
4. **产业链**：上下游价格、产销数据、利润情况
5. **政策面**：行业政策、环保限产、关税调整
6. **进出口**：进出口量、内外价差、国际供需
7. **市场情绪**：多空比例、情绪指标、市场热度
8. **风险因素**：潜在风险、止损建议、仓位控制

每个维度2个关键词，每关键词搜索2条专业信息，共32条数据支撑分析。

#### 新闻资讯生成
- AI智能筛选10-15条重要新闻
- 5大筛选维度：相关性、时效性、重要性、完整性、独特性
- 自动去重，格式统一
- 学术引用格式[1][2][3]

### 📝 灵活编辑体验
- **三大内容模块**：行情描述、主要观点、新闻资讯
- **全部可编辑**：AI生成后可自由修改、增删、调整
- **人机协作**：AI提供专业参考，人工把关最终内容
- **状态保持**：多次生成结果同时显示，不会相互覆盖

### 📊 数据可追溯性
- 所有数字标注数据来源
- 新闻标注发布日期和媒体
- 附录提供完整参考文献列表
- 日期参数全链路传递，确保时效性

### 📄 专业报告输出
- Word格式，机构级排版
- 包含K线图、走势分析、主要观点、市场资讯
- 附录：参考文献（含完整链接）
- 自动保存到桌面/期货日报文件夹

---

## 🚀 使用方法

### 方式一：在线访问（推荐）

**适合：**普通用户、快速使用、无需安装

访问已部署的在线地址：
```
https://futuresdaily.streamlit.app/
```

**优势：**
- ✅ 无需安装任何软件
- ✅ 任何设备随时访问
- ✅ 自动更新到最新版本
- ✅ API密钥已内置配置

---

### 方式二：本地部署

**适合：**开发者、定制需求、内网使用

#### 1. 环境准备
```bash
# 安装Python 3.9或更高版本
# 下载地址：https://www.python.org/downloads/
```

#### 2. 克隆项目
```bash
git clone https://github.com/haoge10241024/futures_daily_report.git
cd futures_daily_report
```

#### 3. 安装依赖
```bash
pip install -r requirements.txt
```

#### 4. 运行应用
```bash
streamlit run 期货日报_AI增强专业版.py
```

应用会自动在浏览器中打开，默认地址：`http://localhost:8501`

#### 5. API配置（可选）

系统已内置API密钥，无需额外配置。如需使用自己的API密钥：

**方式1：环境变量**
```bash
# Windows (PowerShell)
$env:DEEPSEEK_API_KEY="sk-your-key"
$env:SERPER_API_KEY="your-key"
streamlit run 期货日报_AI增强专业版.py

# Linux/Mac
export DEEPSEEK_API_KEY="sk-your-key"
export SERPER_API_KEY="your-key"
streamlit run 期货日报_AI增强专业版.py
```

**方式2：侧边栏输入**
- 启动应用后，在左侧边栏输入API密钥
- 系统实时显示配置状态

**API申请：**
- **DeepSeek API**：https://platform.deepseek.com/ （新用户免费额度）
- **Serper API**：https://serper.dev/ （新用户2,500次免费搜索）

---

## 📝 操作指南

### 第一步：输入基本信息
1. **选择日期**：选择需要分析的交易日（建议选择T-1日，即昨日）
2. **输入品种名称**：直接输入中文，如"黄金"、"铜"、"螺纹钢"
3. **输入合约代码**：输入完整合约，如"AU2506"、"CU2501"、"RB2505"

> 💡 **提示**：合约格式 = 品种代码 + 年月，如AU2506表示2025年6月交割的黄金合约

### 第二步：生成K线图
1. 点击 **"🎨 生成K线图"** 按钮
2. 系统自动：
   - 获取日盘和夜盘数据
   - 绘制K线走势图
   - 计算涨跌幅
   - 搜索相关新闻

### 第三步：AI生成内容（可选）

#### 方案A：AI生成行情描述
1. 点击 **"🤖 AI生成行情描述"**
2. AI基于真实K线数据生成专业描述
3. 生成结果显示在下方预览区
4. 手动复制到上方输入框，或直接在输入框编辑

#### 方案B：AI生成主要观点（推荐）
1. 点击 **"🧠 AI生成主要观点（专业版）"**
2. AI自动：
   - 计算技术指标（MA、MACD、RSI、布林带）
   - 搜索8大维度专业数据（库存、基差、持仓等）
   - 综合分析生成300-400字观点
3. 生成结果显示在下方预览区
4. 手动复制到上方输入框，或直接编辑

#### 方案C：AI生成新闻资讯
1. 点击 **"📰 AI生成新闻资讯"**
2. AI智能筛选10-15条重要新闻
3. 格式统一，自动标注引用[1][2][3]
4. 生成结果显示在下方预览区
5. 手动复制或编辑内容

> 💡 **提示**：三个AI生成按钮互不干扰，可以同时生成，结果会同时显示

### 第四步：编辑完善（可选）
- 在上方输入框中自由编辑AI生成的内容
- 可以删除、修改、补充任何部分
- 可以完全不使用AI生成，手动输入

### 第五步：生成日报
1. 点击 **"📄 生成完整日报"** 按钮
2. 系统自动生成Word文档
3. 文档保存在：`桌面/期货日报/期货日报_YYYY-MM-DD/`
4. 包含内容：
   - 标题和日期
   - K线图
   - 一、市场走势回顾
   - 二、主要观点
   - 三、市场资讯
   - 附录：参考文献

### 第六步：下载使用
- 在桌面找到生成的Word文档
- 可继续在Word中编辑
- 打印或分享给团队

---

## 💡 使用技巧

### 合约代码速查

| 品种 | 代码 | 示例 | 交易所 |
|------|------|------|--------|
| 黄金 | AU | AU2506 | 上期所 |
| 铜 | CU | CU2501 | 上期所 |
| 螺纹钢 | RB | RB2505 | 上期所 |
| 铁矿石 | I | I2505 | 大商所 |
| 豆粕 | M | M2505 | 大商所 |
| PTA | TA | TA2505 | 郑商所 |
| 生猪 | LH | LH2511 | 大商所 |

> 💡 **提示**：合约月份通常选择主力合约或次主力合约

### 最佳实践

1. **选择合适的日期**
   - 选择有交易的工作日
   - 避免节假日和周末
   - 建议选择T-1日（昨日）

2. **充分利用AI功能**
   - 先生成K线图，AI生成更准确
   - 可以多次生成，选择最满意的
   - AI生成后一定要人工审核

3. **编辑技巧**
   - 行情描述：简洁明了，突出涨跌幅和关键点位
   - 主要观点：逻辑清晰，有数据支撑，给出明确建议
   - 新闻资讯：筛选重要新闻，删除无关内容

4. **质量把控**
   - 检查数字的准确性
   - 确认日期正确
   - 验证新闻的时效性
   - 确保逻辑连贯

---

## ⚠️ 注意事项

1. **合约代码格式**
   - 必须大写，如CU2501（不是cu2501）
   - 年份用2位数，如25表示2025年
   - 月份用2位数，如01表示1月

2. **数据获取**
   - 需要稳定的网络连接
   - 部分数据接口有频率限制
   - 非交易时段可能无法获取实时数据

3. **AI生成内容**
   - AI生成内容仅供参考
   - 必须人工审核和编辑
   - 不应完全依赖AI判断
   - 所有投资决策需自行负责

4. **文件保存**
   - 确保有桌面写入权限
   - 如保存失败，会生成唯一文件名重试
   - 建议及时整理生成的文档

---

## 🆘 常见问题

### Q1: 如何访问在线版本？
**A:** 请使用提供的Streamlit应用链接直接访问，无需安装。

### Q2: K线图无法生成怎么办？
**A:** 
- 检查合约代码格式是否正确
- 确认选择的日期是交易日
- 确保网络连接稳定
- 尝试更换其他品种测试

### Q3: AI生成功能无响应？
**A:** 
- 检查网络连接
- 确认已先生成K线图
- 等待30秒-1分钟，AI生成需要时间
- 查看是否有错误提示

### Q4: AI生成的内容不满意？
**A:** 
- 可以多次点击重新生成
- 可以手动编辑AI生成的内容
- 可以完全不用AI，手动输入
- AI生成仅供参考，最终内容由您决定

### Q5: 如何选择合适的合约月份？
**A:** 
- 查看交易所主力合约列表
- 一般选择成交量最大的合约
- 黄金通常选择偶数月（如2月、4月、6月）
- 螺纹钢通常选择1、5、10月

### Q6: 生成的报告可以修改吗？
**A:** 
- 生成的是Word文档，可以在Word中继续编辑
- 建议在系统中编辑好再生成，减少后期修改

### Q7: 支持哪些期货品种？
**A:** 
- 支持国内4大期货交易所的所有主流品种
- 包括金属、能源、农产品、化工等50+个品种
- 输入中文品种名称系统会自动识别

### Q8: API密钥如何获取？
**A:** 
- 系统已内置API密钥，无需配置
- 如需使用自己的密钥，请访问：
  - DeepSeek: https://platform.deepseek.com/
  - Serper: https://serper.dev/

---

## 🔧 技术栈

- **前端框架**：Streamlit
- **数据获取**：AkShare
- **数据处理**：Pandas、NumPy
- **图表绘制**：Matplotlib、mplfinance
- **文档生成**：python-docx
- **AI模型**：DeepSeek API
- **新闻搜索**：Serper API
- **网页解析**：BeautifulSoup4、feedparser

---

## 📦 依赖说明

```txt
streamlit>=1.28.0          # Web应用框架
akshare>=1.11.0            # 金融数据接口
pandas>=2.0.0              # 数据处理
matplotlib>=3.7.0          # 绘图库
mplfinance>=0.12.10        # K线图专用
python-docx>=1.1.0         # Word文档生成
requests>=2.31.0           # HTTP请求
beautifulsoup4>=4.12.0     # HTML解析
feedparser>=6.0.10         # RSS解析
lxml>=4.9.0                # XML解析
```

---

## 🎓 学习资源

### 相关文档
- 📄 [快速部署指南](快速部署指南.md) - 5分钟部署到云端
- 📁 [GitHub部署准备](GitHub部署准备说明.md) - 文件整理指南
- 🔧 [API配置说明](API配置说明.md) - API密钥申请教程
- 📖 [Streamlit部署详解](Streamlit部署指南.md) - 完整部署教程

### 技术参考
- [Streamlit官方文档](https://docs.streamlit.io/)
- [AkShare文档](https://akshare.akfamily.xyz/)
- [DeepSeek API文档](https://platform.deepseek.com/docs)
- [Serper API文档](https://serper.dev/docs)

---

## 📧 联系方式

**作者**：7haoge  
**邮箱**：953534947@qq.com  
**GitHub**：https://github.com/haoge10241024/futures_daily_report

如有问题、建议或合作意向，欢迎联系！

---

## 📄 开源协议

本项目采用 MIT 协议开源，允许自由使用、修改和分发。

---

## 🙏 致谢

感谢以下开源项目和服务：
- Streamlit - 优雅的Python Web框架
- AkShare - 免费的金融数据接口
- DeepSeek - 强大的中文AI模型
- Serper - 高效的搜索API服务

---

**⭐ 如果这个项目对您有帮助，欢迎Star支持！**
